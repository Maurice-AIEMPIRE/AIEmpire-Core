name: Revenue Tracking

on:
  schedule:
    # Check revenue daily at 9 AM UTC
    - cron: '0 9 * * *'
  workflow_dispatch:

jobs:
  track-revenue:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Generate Revenue Report
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const timestamp = new Date().toISOString().split('T')[0];
            
            // Read existing revenue data if available
            let revenueData = {
              total: 0,
              streams: {
                gumroad: 0,
                fiverr: 0,
                x_leads: 0,
                consulting: 0
              },
              history: []
            };
            
            // Generate daily report
            const report = `# Daily Revenue Report - ${timestamp}\n\n` +
              `## Current Status\n` +
              `**Total Revenue:** EUR ${revenueData.total}\n` +
              `**Target:** EUR 50-100 overnight\n\n` +
              `## Revenue Streams\n` +
              `| Stream | Amount | Status |\n` +
              `|--------|--------|--------|\n` +
              `| Gumroad | EUR ${revenueData.streams.gumroad} | 1 product |\n` +
              `| Fiverr | EUR ${revenueData.streams.fiverr} | No gigs |\n` +
              `| X Leads | EUR ${revenueData.streams.x_leads} | Ready |\n` +
              `| Consulting | EUR ${revenueData.streams.consulting} | Not started |\n\n` +
              `## Action Items\n` +
              `1. [ ] Post X content daily\n` +
              `2. [ ] Create 3 Fiverr gigs\n` +
              `3. [ ] Launch 2 more Gumroad products\n` +
              `4. [ ] Set up lead capture\n` +
              `5. [ ] Start consulting offers\n\n` +
              `## Growth Metrics\n` +
              `- X Followers: Track manually\n` +
              `- Email Subscribers: 0\n` +
              `- Product Views: Track in Gumroad\n` +
              `- Gig Impressions: Track in Fiverr\n\n` +
              `---\n*Report generated automatically by GitHub Actions*`;
            
            // Create issue with revenue report
            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `ðŸ’° Daily Revenue Report - ${timestamp}`,
              body: report,
              labels: ['revenue', 'tracking', 'daily-report']
            });
            
            console.log('Revenue report generated');
